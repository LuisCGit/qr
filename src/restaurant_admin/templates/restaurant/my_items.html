{% extends 'restaurant/base.html' %}
{% load i18n %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<html>
<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <!-- <head>
    <style>

    </style>
  </head> -->

  <body>
    <div class="container">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <!-- <div class = 'card border-secondary bg-light mt-5 mb-5' id ='big_card_container'> -->

          <!-- <div class ='card-header'> -->

          <!-- the alert card if they havent picked to handle payments or not -->
          {% if me.answered_pay_question == False %}
            <div class = 'row justify-content-center mb-2'>
              <div class="card text-white bg-warning mb-3" style = 'width: 20rem;'>
                <div class = 'card-body'>
                  <div class = 'row justify-content-center'>
                    <div class = 'col'>
                      <h5>{% trans 'Would You Like Us to Handle the Payment Process for You?' %}</h5>
                    </div>
                  </div>
                  <div class = 'row justify-content-center mt-2'>
                    <div class = 'col'>
                      <form action = '/restaurant_admin/answer_question' method = 'post'>
                        {% csrf_token %}
                        <div class = 'row'>
                          <div class = 'col'>
                            <input type="radio" id="no" name="answer" value="no">
                            <label for="no">{% trans 'No' %}</label><br>
                          </div>
                          <div class = 'col ml-3'>
                            <input type="radio" id="yes" name="answer" value="yes">
                            <label for="yes">{% trans 'Yes' %}</label><br>
                          </div>
                        </div>

                        <div class = 'row justify-content-center'>
                          <div class = 'col'>
                            <button class = 'rounded' type = 'submit'>{% trans 'Submit' %}</button>
                          </div>
                        </div>

                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}

            <div class = 'row justify-content-center mb-2'>
              <h2>
                <b>
                  {% trans "Add Items" %}
                </b>
                <a style = 'cursor: pointer;'>
                  <svg class="bi bi-plus-circle-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-toggle="modal" data-target="#add_modal">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4a.5.5 0 0 0-1 0v3.5H4a.5.5 0 0 0 0 1h3.5V12a.5.5 0 0 0 1 0V8.5H12a.5.5 0 0 0 0-1H8.5V4z"/>
                  </svg>
                </a>
              </h2>
            </div>
            <!-- modal that pops up when item is to be created-->
            <div class="modal fade bd-example-modal-lg" id="add_modal" tabindex="-1" role="dialog">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-body">
                    <!--hidden form to add new item -->
                    <div class = 'row justify-content-center'>
                      <div class="card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;" id = 'new_item_form'>

                          <div class ='row justify-content-center'>
                            <h3 class="card-title">{% trans "Create New Item" %}</h3>
                          </div>
                        <div class="card-body d-flex justify-content-center">
                          <form action= "/restaurant_admin/add_item_no_menu" method="post" enctype="multipart/form-data">
                            {% csrf_token %}

                            <div class="row justify-content-center mt-2 mb-2">
                              <div class = 'col'>
                                {{ item_form.name|as_crispy_field }}
                              </div>
                            </div>

                            <div class="row justify-content-center mt-2 mb-2">
                              <div class = 'col'>
                                {{ item_form.description|as_crispy_field }}
                              </div>
                            </div>

                            <div class="row justify-content-center mt-2 mb-2">
                              <div class = 'col'>
                                {{ item_form.course|as_crispy_field }}
                              </div>
                            </div>

                            <div class="row justify-content-center mt-2 mb-2">
                              <div class = 'col'>
                                {{ item_form.price|as_crispy_field }}
                              </div>
                            </div>

                            <div class="row justify-content-center mt-3 mb-2">
                              <div class = 'col'>
                                <label for = 'photo'>{% trans 'Item Photo' %}</label>
                                <input type = 'file' accept="image/*" id = 'photo' name = "photo" required>
                              </div>
                            </div>

                            <!-- Buttons -->
                            <div class="row justify-content-center mt-3 mb-2">
                              <div class = 'col'>
                                <div class="btn-group">
                                    <button type="submit" class="btn btn-primary">{% trans "Create" %}</button>
                                </div>
                              </div>
                            </div>

                          </form>

                        </div>
                      </div>
                  </div>
              </div>
            </div>
          </div>
        </div>
          <!-- </div> -->
          <div class="container">
            <div class="row">
              {% for item in items %}
              <div class="col-sm-4 py-2">
                  <div class="card h-100 border-secondary" style="margin-bottom: 0 !important;">
                      <div class="card-body mb-0">
                          <h4 class="card-title">{{item.name}}</h4>
                          <a style = 'cursor: pointer; position: absolute; top: 20px; right: 10px;'>
                            <svg class="bi bi-pencil" width="1.25em" height="1.25em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-toggle="modal" data-target="#edit_modal{{item.id}}">
                              <path fill-rule="evenodd" d="M11.293 1.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1 0 1.414l-9 9a1 1 0 0 1-.39.242l-3 1a1 1 0 0 1-1.266-1.265l1-3a1 1 0 0 1 .242-.391l9-9zM12 2l2 2-9 9-3 1 1-3 9-9z"/>
                              <path fill-rule="evenodd" d="M12.146 6.354l-2.5-2.5.708-.708 2.5 2.5-.707.708zM3 10v.5a.5.5 0 0 0 .5.5H4v.5a.5.5 0 0 0 .5.5H5v.5a.5.5 0 0 0 .5.5H6v-1.5a.5.5 0 0 0-.5-.5H5v-.5a.5.5 0 0 0-.5-.5H3z"/>
                            </svg>
                          </a>
                          <p class="card-text">{{item.description}}</p>
                          <img class="img-fluid rounded" src="{% static item.photo_path %}" alt="Responsive image">
                          <br>
                          <br>
                          <div class="row" style="width: 100%; text-align: right; margin-bottom: 0 !important;">
                            <strong>Price : ${{item.price}}</strong>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- modal that pops up when item is to be edited-->
              <div class="modal fade bd-example-modal-lg" id="edit_modal{{item.id}}" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                  <div class="modal-content">
                    <div class="modal-body">
                      <!--hidden form to edit new item -->
                      <div class = 'row justify-content-center'>
                        <div class="card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;" id = 'new_item_form'>

                            <div class ='row justify-content-center'>
                              <h3 class="card-title">{% trans "Edit Item" %}</h3>
                            </div>
                            <div class = 'card-body'>
                              <form action = '/restaurant_admin/edit_item/{{menu.id}}/{{item.id}}' method = 'post' enctype = 'multipart/form-data'>
                                {% csrf_token %}
                                <div class="col mt-2">
                                  <label for='name'>{% trans 'Name' %}</label>
                                  <input type = 'text' id = 'name' name = 'name' value = "{{item.name}}">
                                </div>

                                <div class="col-8 mt-2">
                                  <label for='description'>{% trans 'Description' %}</label>
                                  <textarea rows = '4' cols = '23' id = 'description' name = 'description' placeholder = "{{item.description}}"></textarea>
                                </div>

                                <div class="col-8 mt-2">
                                  <label for='course'>{% trans 'Category' %}</label>
                                  <input id = 'course' name = 'course' list = 'options' placeholder = "{{item.course}}">
                                  <datalist id = 'options'>
                                    {% for option in selct_options %}
                                      <option value = {{option}} {% if option.name == item.course %} selected{% endif %}>
                                    {% endfor %}
                                  </datalist>
                                </div>

                                <div class="col-8 mt-2">
                                  <label for='price'>{% trans 'Price' %}</label>
                                  <input type = 'number' step = '0.01' id = 'price' name = 'price' value = {{item.price}}>
                                </div>

                                <div class="col-8 mt-2">
                                  <label for = 'photo'>{% trans 'Photo' %}</label>
                                  <input type = 'file' accept="image/*" id = 'photo' name = "photo">
                                </div>

                                <div class = 'col'>
                                  <div class="btn-group mt-2">
                                      <button type="submit" class="btn btn-primary">{% trans "Update" %}</button>
                                  </div>
                                </div>

                                <div class = 'col mt-4'>
                                  <a style = 'color:red;' href = '/restaurant_admin/remove_item/{{menu.id}}/{{item.id}}'>{% trans 'Remove This Item' %}</a>
                                </div>

                              </form>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
              {% endfor %}
            </div>
          </div>
          <!-- </div> -->
        <!-- </div> -->

  </body>
  <script>
    function asd(a)
    {
        if(document.getElementById("menu_form").style.display=="block") document.getElementById("menu_form").style.display = 'none';

        else
            document.getElementById("menu_form").style.display="block";
    }
    function showItemForm(a){
      if(document.getElementById('item'+a).style.display == 'block') document.getElementById('item'+a).style.display = 'none';
      else document.getElementById('item'+a).style.display = 'block';
    }
    function newItemForm(){
      if(document.getElementById('new_item_form').style.display == 'block') document.getElementById('new_item_form').style.display = 'none';
      else document.getElementById('new_item_form').style.display = 'block';
    }
  </script>
  <script>
    function menuForm(){
      if(document.getElementById('menu_form').style.display == 'block') document.getElementById('menu_form').style.display = 'none'
      else document.getElementById('menu_form').style.display = 'block'
    }
  </script>
</html>
<script>
$('#add_modal').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
  })
</script>

{% endblock %}
